<!DOCTYPE html>

<html lang="ja">
<head>
<meta charset="utf-8"/>
<title>[Ruby] 新宿二丁目の処理に失敗-ウンコード・マニア</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="「なんだこの糞コードは!(怒)」「書いた奴出てこい!(怒)」 こんな声を聞いたり、叫んだりしたことはありませんか？ ウンコードについて学ぶことによってウンコードを撲滅しましょう！ とりあえず、趣のあるウンコード鑑賞から始めて下さい" name="description"/>
<meta content="プログラミング,プログラマ,ウンコード,クソース,糞コード,unkode,uncode" name="keywords"/>
<meta content="smeghead" name="author"/>
<!-- Le styles -->
<link href="../css/bootstrap.min.css" rel="stylesheet"/>
<style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
    </style>
<link href="../css/bootstrap-responsive.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
<link href="../css/style.css" rel="stylesheet"/>
<link href="https://unkode-mania.net/rss" rel="alternate" title="ウンコード・マニア" type="application/rss+xml"/>
<link href="../favicon.ico" rel="shortcut icon"/>
<link href="../img/unkode32.png" rel="apple-touch-icon"/>
<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
<!-- Le fav and touch icons -->
<link href="../favicon.ico" rel="shortcut icon"/>
<link href="../favicon.ico" rel="apple-touch-icon-precomposed"/>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-B4VEMNV1D0"></script>
<script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-B4VEMNV1D0');
    </script>
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-33744676-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
<script async="" data-ad-client="ca-pub-6994803411870749" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script src="../js/jquery-1.7.2.min.js"></script>
</head>
<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/ja_JP/all.js#xfbml=1&appId=139930182876459";
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));</script>
<input id="mobile" type="hidden" value=""/>
<script>
      var screen_name = '';
    </script>
<div class="navbar navbar-fixed-top">
<div class="navbar-inner">
<div class="container-fluid">
<a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</a>
<a class="brand" href="/index.html">ウンコード・マニア</a>
<div class="nav-collapse">
<ul class="nav">
<li><a href="/index.html">ホーム</a></li>
<li><a href="/about.html">ウンコード・マニアについて</a></li>
<li><a href="mailto:smeghead7+unkode@gmail.com">Contact</a></li>
</ul>
</div><!--/.nav-collapse -->
</div>
</div>
</div>
<div class="container-fluid">
<div class="row-fluid">
<div class="span3">
<div class="well sidebar-nav">
<ul class="nav nav-list">
<li data-url_match="^/$"><a href="/index.html"><i class="icon-home"></i>ホーム</a></li>
<li data-url_match="^/ranking$"><a href="/ranking.html"><i class="icon-flag"></i>職人ランキング</a></li>
</ul>
<ul class="nav nav-list">
<li class="nav-header">ウンコードを鑑賞する</li>
<li data-url_match="/legend"><a href="/legend.html"><i class="icon-film"></i>殿堂入りウンコード</a></li>
<li data-url_match="/search"><a href="https://unkode-mania.net/search"><i class="icon-search"></i>サイト内検索</a></li>
<li data-url_match="/lang/C$"><a href="/lang/C.html"><i class="icon-list-alt"></i>C(85)</a></li>
<li data-url_match="/lang/Java$"><a href="/lang/Java.html"><i class="icon-list-alt"></i>Java(80)</a></li>
<li data-url_match="/lang/PHP$"><a href="/lang/PHP.html"><i class="icon-list-alt"></i>PHP(59)</a></li>
<li data-url_match="/lang/JavaScript$"><a href="/lang/JavaScript.html"><i class="icon-list-alt"></i>JavaScript(55)</a></li>
<li data-url_match="/lang/other$"><a href="/lang/other.html"><i class="icon-list-alt"></i>その他(44)</a></li>
<li data-url_match="/lang/CPP$"><a href="/lang/CPP.html"><i class="icon-list-alt"></i>C++(39)</a></li>
<li data-url_match="/lang/CS$"><a href="/lang/CS.html"><i class="icon-list-alt"></i>C#(35)</a></li>
<li data-url_match="/lang/HTML$"><a href="/lang/HTML.html"><i class="icon-list-alt"></i>HTML(18)</a></li>
<li data-url_match="/lang/Ruby$"><a href="/lang/Ruby.html"><i class="icon-list-alt"></i>Ruby(15)</a></li>
<li data-url_match="/lang/VB.net$"><a href="/lang/VB.net.html"><i class="icon-list-alt"></i>VB.net(13)</a></li>
<li data-url_match="/lang/Python$"><a href="/lang/Python.html"><i class="icon-list-alt"></i>Python(11)</a></li>
<li data-url_match="/lang/VBA$"><a href="/lang/VBA.html"><i class="icon-list-alt"></i>VBA(8)</a></li>
<li data-url_match="/lang/ObjC$"><a href="/lang/ObjC.html"><i class="icon-list-alt"></i>Objective-C(6)</a></li>
<li data-url_match="/lang/typescript$"><a href="/lang/typescript.html"><i class="icon-list-alt"></i>TypeScript(3)</a></li>
<li data-url_match="/lang/Perl$"><a href="/lang/Perl.html"><i class="icon-list-alt"></i>Perl(3)</a></li>
<li data-url_match="/lang/ActionScript$"><a href="/lang/ActionScript.html"><i class="icon-list-alt"></i>ActionScript(1)</a></li>
<li data-url_match="/lang/Cobol$"><a href="/lang/Cobol.html"><i class="icon-list-alt"></i>Cobol(1)</a></li>
<li class="nav-header">ウンコード</li>
<li data-url_match="^/about$"><a href="/about.html"><i class="icon-info-sign"></i>ウンコード・マニアについて</a></li>
</ul>
</div><!--/.well -->
<a class="twitter-timeline" data-widget-id="355147085391212544" href="https://twitter.com/unkode_mania">Tweets by @unkode_mania</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div><!--/span-->
<div class="span9">
<div data-id="513894dbff22d3202c000002" id="code-info"></div>
<script>
            var smell_json = '[{"id":"513896cdff22d3202c000003","author":{"user_id":null,"screen_name":"nullshooter2"},"line":1},{"id":"5138972bff22d3202c000005","author":{"user_id":null,"screen_name":"nullshooter2"},"line":1},{"line":1,"id":"5138972cff22d3202c000006","author":{"screen_name":"nullshooter2","user_id":null}},{"line":1,"id":"5138972bff22d3202c000004","author":{"user_id":null,"screen_name":"nullshooter2"}},{"line":1,"author":{"screen_name":"Sa2Knight","user_id":"341992852"},"id":"517eed3f1cf16da521000002"},{"author":{"user_id":"1157193140","screen_name":"andoshin11"},"id":"592fa28bd271b70b1d000010","line":1},{"author":{"screen_name":"tkcomcom1is","user_id":null},"id":"5138bd85ff22d3202c000007","line":2},{"line":2,"author":{"screen_name":"tkcomcom1is","user_id":null},"id":"5138bd89ff22d3202c000008"},{"id":"62bdb275b5b137cec6e43be7","author":{"user_id":"1250491831","screen_name":"alchemiltank"},"line":2}]';
          </script>
<div class="row-fluid view">
<ul class="breadcrumb">
<li>
<a href="/index.html">ホーム</a> <span class="divider">/</span>
</li>
<li>
<a href="/lang/Ruby.html">Ruby</a>
<span class="divider">/</span>
</li>
<li class="active">
<a href="513894dbff22d3202c000002.html">新宿二丁目の処理に失敗</a>
</li>
</ul>
<div class="property">
<a href="https://twitter.com/intent/user?screen_name=jkr_2255">
                jkr_2255
              </a>
              2013-03-07 13:23:39
            </div>
<h2 class="title">
              [Ruby]
              新宿二丁目の処理に失敗
              <a class="hatena-bookmark-button" data-hatena-bookmark-layout="standard" data-hatena-bookmark-title="[Ruby] 新宿二丁目の処理に失敗 - ウンコード・マニア" href="https://b.hatena.ne.jp/entry/https://unkode-mania.net/view/513894dbff22d3202c000002" title="このエントリーをはてなブックマークに追加"><img alt="このエントリーをはてなブックマークに追加" height="20" src="https://b.st-hatena.com/images/entry-button/button-only.gif" style="border: none;" width="20"/></a>
<a class="twitter-share-button" data-hashtags="unkode" data-text="[Ruby] 新宿二丁目の処理に失敗 - ウンコード・マニア" data-url="https://unkode-mania.net/view/513894dbff22d3202c000002" href="https://twitter.com/share"></a>
</h2>
<h3 class="clear">投稿者からのアピールポイント</h3>
<div class="markdown"><p>昔から、Iとlと1とか、Oと0とかを見分けやすいフォントは普及していますが、日本語で似たような文字を容易に判別できるフォントはあまり見ない気がします。</p>
</div>
<pre class="prettyprint linenums">#住所の変換処理
address=address.gsub('一丁目','1丁目')
  .gsub('ニ丁目','2丁目')
  .gsub('三丁目','3丁目')
  .gsub('四丁目','4丁目')
  .gsub('五丁目','5丁目')
#（実際にはもっと続くし、もう少し複雑な処理をしていますが省略）</pre>
<h3>コメント(24)</h3>
<div class="comment-block" id="comment-5139dd90ff22d3db0b000001">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_5139dd90ff22d3db0b000001">#1</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=keiichiroh">
                    keiichiroh
                  </a>
                  2013-03-08 12:46:08
                  <a class="comment-anchor" name="comment_5139dd90ff22d3db0b000001"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>ニと二は・・・どうしようもないねぇ。コード表記したとしても可読性は向上しないし。
明朝でセリフつけるくらい？</p>
</div>
</div>
<div class="comment-block" id="comment-513bd093ff22d3d660000000">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_513bd093ff22d3d660000000">#2</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=token7">
                    token7
                  </a>
                  2013-03-10 00:15:15
                  <a class="comment-anchor" name="comment_513bd093ff22d3d660000000"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>うん？なんでコード書いてるのに肉眼に頼ろうとしてんの？</p>
</div>
</div>
<div class="comment-block" id="comment-513e6628ff22d3fe23000000">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_513e6628ff22d3fe23000000">#3</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=InternalServerE">
                    InternalServerE
                  </a>
                  2013-03-11 23:18:00
                  <a class="comment-anchor" name="comment_513e6628ff22d3fe23000000"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>文字列検索・置換が数珠つなぎになってる点はツッコまなくていいものなん？</p>
</div>
</div>
<div class="comment-block" id="comment-513e7b7aff22d3fe23000001">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_513e7b7aff22d3fe23000001">#4</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=keiichiroh">
                    keiichiroh
                  </a>
                  2013-03-12 00:48:58
                  <a class="comment-anchor" name="comment_513e7b7aff22d3fe23000001"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>うん・・・コード表記なんて曖昧なこと言ってごめんなさい。普通にUnicodeエスケープシーケンスの事と分かってくれると思ってしまった。"\u93f1丁目"とかと書いても可読性が向上しないと。</p>
</div>
</div>
<div class="comment-block" id="comment-51429c3cff22d30747000002">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_51429c3cff22d30747000002">#5</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=Miraranran">
                    Miraranran
                  </a>
                  2013-03-15 03:57:48
                  <a class="comment-anchor" name="comment_51429c3cff22d30747000002"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>ユーザーが「に」からの変換でやらかす場合があるからカタカナニと数字二の両方の処理をつくっておくほうがいいに違いない。
数珠つなぎはjquery普及しすぎてみんな感覚麻痺してないかな。jqueryキモイ...</p>
</div>
</div>
<div class="comment-block" id="comment-5142ec71ff22d30747000016">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_5142ec71ff22d30747000016">#6</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=jkr_2255">
                    jkr_2255
                  </a>
                  2013-03-15 09:40:01
                  <a class="comment-anchor" name="comment_5142ec71ff22d30747000016"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>Ruby自身も、1.9から「メソッド呼び出し直前のピリオドの前で改行できるようになった」と文法を変えているぐらいだからなあ&gt;数珠つなぎ</p>
</div>
</div>
<div class="comment-block" id="comment-5144f82eff22d36220000000">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_5144f82eff22d36220000000">#7</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=InternalServerE">
                    InternalServerE
                  </a>
                  2013-03-16 22:54:38
                  <a class="comment-anchor" name="comment_5144f82eff22d36220000000"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>もちろん数珠つなぎ自体が悪いわけじゃなく、使い方と程度次第だぁね。<br/>
このコードだと、「一丁目」がヒットした場合、二丁目以降は事実上ヒットしないわけで、空振りの検索置換が延々と続く構図になる。<br/>
無駄にCPUパワーを浪費する悪の枢軸です。</p>
</div>
</div>
<div class="comment-block" id="comment-51498f5fff22d3e620000002">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_51498f5fff22d3e620000002">#8</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=keiichiroh">
                    keiichiroh
                  </a>
                  2013-03-20 10:28:47
                  <a class="comment-anchor" name="comment_51498f5fff22d3e620000002"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>最初のヒットで抜けることが出来るなんて条件は一つも書かれていない。
"一丁目10番,五丁目3番"とかという可能性も考慮しようよ。</p>
</div>
</div>
<div class="comment-block" id="comment-514a1549ff22d3af1c000004">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_514a1549ff22d3af1c000004">#10</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=InternalServerE">
                    InternalServerE
                  </a>
                  2013-03-20 20:00:09
                  <a class="comment-anchor" name="comment_514a1549ff22d3af1c000004"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>ええと、<br/>
&gt; "一丁目10番,五丁目3番" <br/>
という文字が入力なら、この実装は妥当、というご意見ですかね。ホントにほんとかなぁ。。<br/>
自分ならまずこんな実装はしないし、臭いが変わるだけでいずれにせよウンコに見えてしまう。。</p>
</div>
</div>
<div class="comment-block" id="comment-515986b7ff22d33875000001">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_515986b7ff22d33875000001">#11</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=slimymars">
                    slimymars
                  </a>
                  2013-04-01 13:08:07
                  <a class="comment-anchor" name="comment_515986b7ff22d33875000001"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>そんなんより十一丁目の処理のがうんこっぽそう。</p>
</div>
</div>
<div class="comment-block" id="comment-5162475eff22d37527000004">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_5162475eff22d37527000004">#12</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=InternalServerE">
                    InternalServerE
                  </a>
                  2013-04-08 04:28:14
                  <a class="comment-anchor" name="comment_5162475eff22d37527000004"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>「実際にはもっと続く」らしいし、十一以降も延々とgsubでないの。</p>
</div>
</div>
<div class="comment-block" id="comment-516293f4ff22d39520000013">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_516293f4ff22d39520000013">#13</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=kuma056">
                    kuma056
                  </a>
                  2013-04-08 09:55:00
                  <a class="comment-anchor" name="comment_516293f4ff22d39520000013"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p><code>.gsub('十一丁目','11丁目)</code>
だと期待通りに動かないから
<code>.gsub('十1丁目','11丁目')</code>
ってことでしょうか.....どっちにしてもちょっと...</p>
</div>
</div>
<div class="comment-block" id="comment-5162a138ff22d39520000015">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_5162a138ff22d39520000015">#14</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=InternalServerE">
                    InternalServerE
                  </a>
                  2013-04-08 10:51:36
                  <a class="comment-anchor" name="comment_5162a138ff22d39520000015"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>ああ、確かに<br/>
slimymarsさんの主旨に気づけなかったorz</p>
</div>
</div>
<div class="comment-block" id="comment-516ffcca1cf16dfb45000001">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_516ffcca1cf16dfb45000001">#15</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=keiichiroh">
                    keiichiroh
                  </a>
                  2013-04-18 14:01:46
                  <a class="comment-anchor" name="comment_516ffcca1cf16dfb45000001"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>んー、うんこって簡単に言ってる人、代案あって言ってるんだよね？</p>
</div>
</div>
<div class="comment-block" id="comment-5170dc1d1cf16d0f32000000">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_5170dc1d1cf16d0f32000000">#16</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=kuma056">
                    kuma056
                  </a>
                  2013-04-19 05:54:37
                  <a class="comment-anchor" name="comment_5170dc1d1cf16d0f32000000"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>Rubyの場合、ブロックを使って、「マッチした内容を元に演算した値で置換」ってことができますから</p>
<pre><code>address=address.gsub(/([[:漢数字:]]+)丁目/) { "#{Kansuuji2Int($1)}丁目" }
</code></pre>
<p>ってやり方があります。[:漢数字:]文字クラスとかKansuuji2Intメソッドとかは疑似コードですけど。</p>
</div>
</div>
<div class="comment-block" id="comment-517113531cf16d8938000001">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_517113531cf16d8938000001">#17</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=Chiether">
                    Chiether
                  </a>
                  2013-04-19 09:50:11
                  <a class="comment-anchor" name="comment_517113531cf16d8938000001"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>(ネタ発言) とりあえず。だいたい北海道のせい。</p>
</div>
</div>
<div class="comment-block" id="comment-51711d511cf16d8938000002">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_51711d511cf16d8938000002">#18</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=InternalServerE">
                    InternalServerE
                  </a>
                  2013-04-19 10:32:49
                  <a class="comment-anchor" name="comment_51711d511cf16d8938000002"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>&gt; keiichirohさん<br/>
簡易な住所パーサー書くかな。自分に限らず、わりとよく使われる手じゃなかろうか。</p>
</div>
</div>
<div class="comment-block" id="comment-517122c11cf16d8938000003">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_517122c11cf16d8938000003">#19</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=InternalServerE">
                    InternalServerE
                  </a>
                  2013-04-19 10:56:01
                  <a class="comment-anchor" name="comment_517122c11cf16d8938000003"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>もちろん自分の方法がベストと言うつもりは更々ないんで、その辺は誤解なきよう。他にも代案なんて考えたらコロコロ出てきそうなものだし。<br/>
ちなみに、keiichirohさんは数珠つなぎがベストという見解？</p>
</div>
</div>
<div class="comment-block" id="comment-51714a931cf16dd218000001">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_51714a931cf16dd218000001">#20</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=jkr_2255">
                    jkr_2255
                  </a>
                  2013-04-19 13:45:55
                  <a class="comment-anchor" name="comment_51714a931cf16dd218000001"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>その後、ちゃんと十の位と一の位を分けて扱って、九十九丁目まで対応しました。</p>
<p>Chietherさん&gt;日本国内で平然と「四十丁目」なんてものが現れる地域は北海道くらいですね。</p>
</div>
</div>
<div class="comment-block" id="comment-517266641cf16d550d000001">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_517266641cf16d550d000001">#22</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=keiichiroh">
                    keiichiroh
                  </a>
                  2013-04-20 09:56:52
                  <a class="comment-anchor" name="comment_517266641cf16d550d000001"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>うん！だって「二丁目」はkuma056さんの方式でいいけど、そもそもの問題である「ニ丁目」はその方式じゃ処理できないから。という理由で、結局はイレギュラーな例に関しては数珠つなぎするしか無いと思うんだ。それならば正規表現混ぜるよりもいっそ全部・・・というのは個人的な嗜好かな。正規表現で大枠押さえて数珠つなぎでフォローというのがベストなのかな。</p>
</div>
</div>
<div class="comment-block" id="comment-51728b2a1cf16d550d000003">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_51728b2a1cf16d550d000003">#23</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=keiichiroh">
                    keiichiroh
                  </a>
                  2013-04-20 12:33:46
                  <a class="comment-anchor" name="comment_51728b2a1cf16d550d000003"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>よく考えると、「ニ丁目」という入力間違いの対処が入っていたけど、その代わりに（元々入っていた？）漢数字の「二丁目」の変換コードを削ってしまったっていうデグレードじゃないかと思ったわけなんだけど、元データにはそういう入力間違いはありえないという要件だったりする？こういう変換をするってことは、手入力データかなと思った。カタカナの「ニ丁目」とかは「にちょうめ」って打って変換すると起こったりする入力間違いだから。あり得ないなら正規表現だけでＯＫのはず。</p>
</div>
</div>
<div class="comment-block" id="comment-51728b641cf16d550d000004">
<div class="comment-header">
<span class="comment-counter right">
<a href="513894dbff22d3202c000002.html#comment_51728b641cf16d550d000004">#24</a>
</span>
<a href="https://twitter.com/intent/user?screen_name=InternalServerE">
                    InternalServerE
                  </a>
                  2013-04-20 12:34:44
                  <a class="comment-anchor" name="comment_51728b641cf16d550d000004"> </a>
</div>
<p class="clear"></p>
<div class="markdown"><p>&gt; 結局はイレギュラーな例に関しては数珠つなぎするしか無いと思うんだ<br/>
はて、それはいったい何故だろう。<br/>
昔(バイトでプログラマーしてた頃だから、十数年前かな)、漢数字⇒int変換用の簡易なパーサー＆変換器を書いたことがあるんだ。<br/>
その時は、実用性半分、遊び心半分で、「拾⇒10」、「四拾⇒40」、「一〇⇒10」、「二十一⇒21」、「二一⇒21」、「七拾五萬百二⇒750102」、「Ｉ⇒1」「Ｏ(オー)⇒0」等々、考えうる様々な表記の揺らぎや誤記に対応しまくったんだけど、大した苦労もなく、割と簡単に書けた記憶がある。後から誤記の対応表を増やすのも至極簡単だった。<br/>
<br/>
そこまでやる必要はないと思うけど、ある程度「まとも」な漢数字解析を計算コスト考慮で作るなら、正規表現や、増してや数珠つなぎなんかでは相当難しいと思うけど。</p>
</div>
</div>


<hr/>
<div class="neighborhoods-navi">
<a class="btn btn-inverse" href="/lang/Ruby.html">« Ruby一覧に戻る</a>
<br class="clear"/>
</div>
<div class="modal hide" id="modal-remove-smell">
<div class="modal-header">
<button class="close" data-dismiss="modal" type="button">×</button>
<h3>ウンコの削除</h3>
</div>
<div class="modal-body">
<p>あなたが付けたウンコなので削除することができます。</p>
<p>ウンコを削除しますか？</p>
</div>
<div class="modal-footer">
<a class="btn btn-danger" href="513894dbff22d3202c000002.html#" id="remove-smell">削除</a>
<a class="btn" data-dismiss="modal" href="513894dbff22d3202c000002.html#">閉じる</a>
</div>
</div>
<div class="modal hide" id="modal-remove-comment">
<div class="modal-header">
<button class="close" data-dismiss="modal" type="button">×</button>
<h3>コメントの削除</h3>
</div>
<div class="modal-body">
<p>あなたが投稿したコメントなので削除することができます。</p>
<p>コメントを削除しますか？</p>
</div>
<div class="modal-footer">
<a class="btn btn-danger" href="513894dbff22d3202c000002.html#" id="remove-comment">削除</a>
<a class="btn" data-dismiss="modal" href="513894dbff22d3202c000002.html#">閉じる</a>
</div>
</div>
</div>
<!-- recommends -->
<h3>このウンコードに臭った人は、こちらのウンコードにも臭ってます</h3>
<div class="row-fluid">
<div class="span4 unko-element">
<h3>
<a class="title" href="5018df3a7e19b40f5a000041.html">
                      [C]
                      すげーちゃんと動く！
                    </a>
</h3>
<div class="property">
<a class="hatena-bookmark-button" data-hatena-bookmark-layout="standard" data-hatena-bookmark-title="[C] すげーちゃんと動く！ - ウンコード・マニア" href="https://b.hatena.ne.jp/entry/https://unkode-mania.net/view/5018df3a7e19b40f5a000041" title="このエントリーをはてなブックマークに追加"><img alt="このエントリーをはてなブックマークに追加" height="20" src="https://b.st-hatena.com/images/entry-button/button-only.gif" style="border: none;" width="20"/></a>
<a class="twitter-share-button" data-hashtags="unkode" data-text="[C] すげーちゃんと動く！ - ウンコード・マニア" data-url="https://unkode-mania.net/view/5018df3a7e19b40f5a000041" href="https://twitter.com/share"></a>
</div>
<div class="markdown clear"><p>結合試験２日前に脱退したうんｋプログラマ...</p>
</div>
<pre class="prettyprint">return 0;
</pre>
<p class="more"><a class="btn btn-primary view-link" href="5018df3a7e19b40f5a000041.html">鑑賞する »</a></p>
</div><!--/span-->
<div class="span4 unko-element">
<h3>
<a class="title" href="52aef600657e6e7108000001.html">
                      [Ruby]
                      えっ？こんなんあるの？
                    </a>
</h3>
<div class="property">
<a class="hatena-bookmark-button" data-hatena-bookmark-layout="standard" data-hatena-bookmark-title="[Ruby] えっ？こんなんあるの？ - ウンコード・マニア" href="https://b.hatena.ne.jp/entry/https://unkode-mania.net/view/52aef600657e6e7108000001" title="このエントリーをはてなブックマークに追加"><img alt="このエントリーをはてなブックマークに追加" height="20" src="https://b.st-hatena.com/images/entry-button/button-only.gif" style="border: none;" width="20"/></a>
<a class="twitter-share-button" data-hashtags="unkode" data-text="[Ruby] えっ？こんなんあるの？ - ウンコード・マニア" data-url="https://unkode-mania.net/view/52aef600657e6e7108000001" href="https://twitter.com/share"></a>
</div>
<div class="markdown clear"><p>レビューでやられました。陽の光を浴びない...</p>
</div>
<pre class="prettyprint">  def next_exp(level, exp)
    level_a ...</pre>
<p class="more"><a class="btn btn-primary view-link" href="52aef600657e6e7108000001.html">鑑賞する »</a></p>
</div><!--/span-->
<div class="span4 unko-element">
<h3>
<a class="title" href="502e55df81376aba02000003.html">
                      [C]
                      switch-caseは現場の臭いがする
                    </a>
</h3>
<div class="property">
<a class="hatena-bookmark-button" data-hatena-bookmark-layout="standard" data-hatena-bookmark-title="[C] switch-caseは現場の臭いがする - ウンコード・マニア" href="https://b.hatena.ne.jp/entry/https://unkode-mania.net/view/502e55df81376aba02000003" title="このエントリーをはてなブックマークに追加"><img alt="このエントリーをはてなブックマークに追加" height="20" src="https://b.st-hatena.com/images/entry-button/button-only.gif" style="border: none;" width="20"/></a>
<a class="twitter-share-button" data-hashtags="unkode" data-text="[C] switch-caseは現場の臭いがする - ウンコード・マニア" data-url="https://unkode-mania.net/view/502e55df81376aba02000003" href="https://twitter.com/share"></a>
</div>
<div class="markdown clear"><p>"とりあえず"で書いた 2010 年 4...</p>
</div>
<pre class="prettyprint">// switch-case にしたいが、関数で値を取得しないといけないため、
...</pre>
<p class="more"><a class="btn btn-primary view-link" href="502e55df81376aba02000003.html">鑑賞する »</a></p>
</div><!--/span-->
</div><!--/row-->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<script async="async" charset="utf-8" src="https://b.st-hatena.com/js/bookmark_button.js" type="text/javascript"></script>
</div><!--/span-->
</div><!--/row-->
<hr/>
<footer>
<p>© smeghead 2012 - 2021</p>
</footer>
</div><!--/.fluid-container-->
<form action="https://unkode-mania.net/signout" id="signout-form" method="post"></form>
<div class="modal hide" id="needs-auth-modal">
<div class="modal-header">
<button class="close" data-dismiss="modal" type="button">×</button>
<h3>Twitter認証が必要です</h3>
</div>
<div class="modal-body">
<p>この操作をするためにはTwitter認証が必要です。</p>
<p>Twitter認証をすれば、コード投稿をしたりコメントしたりsmellボタンを使えるようになります。</p>
</div>
<div class="modal-footer">
<a class="btn btn-primary" href="https://unkode-mania.net/auth">Twitter認証</a>
<a class="btn" data-dismiss="modal" href="513894dbff22d3202c000002.html#">Close</a>
</div>
</div>
<!-- Le javascript
    ================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="../js/jquery.tmpl.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/app.js"></script>
<div class="modal hide" id="modal-rss">
<div class="modal-header">
<button class="close" data-dismiss="modal" type="button">×</button>
<h3>RSSフィード</h3>
</div>
<div class="modal-body">
<p>新着ウンコードと新着コメントのRSSフィードは、Twitterのtweet rssをご利用ください。</p>
<textarea class="uneditable-input" id="rss-feed">https://unkode-mania.net/rss</textarea>
</div>
<div class="modal-footer">
<a class="btn" data-dismiss="modal" href="513894dbff22d3202c000002.html#">閉じる</a>
</div>
</div></body>
</html>
